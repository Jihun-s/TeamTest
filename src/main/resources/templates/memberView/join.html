<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>[ 회원가입 ]</title>
<link rel="stylesheet" type="text/css" th:href="@{/css/styles.css}">
<style>
#msg {
	color: red;
	width: 200px;
	display: inline-block;
}
label {
	width: 50px;
	display: inline-block;
}
</style>
<script th:src="@{/js/jquery-3.6.0.js}"></script>
<script>
$(document).ready(function() {
	
	$('#memberid').keyup(function() {
		let id = $(this).val();

		if (id.length <3 || id.length > 10) {
			$('#msg').html('ID는 3~10자로 입력하세요.');
			$('#submitButton').attr('disabled', true);
			return;
		}
		
		$.ajax({
			url: 'idcheck',
			method: 'post',
			data: { memberid: id },
			success: function(n) {
				if (n == 0) {
					$('#msg').html('');
					$('#submitButton').attr('disabled', false);
				}
				else {
					$('#msg').html('이미 사용중인 ID입니다.');
					$('#submitButton').attr('disabled', true);
				}
			},
			error: function(e) {
				alert(JSON.stringify(e));
			}
		});
	});
	
	$('#submitButton').click(submitButton);
});
	function submitButton(){
		// 비밀번호 길이 체크
		let password = document.getElementById("memberpw").value;
		if (password.length > 16) {
			alert("비밀번호는 16글자 이내로 입력해주세요.");
			return false;
		}
		if (password.length < 5) {
			alert("비밀번호는 5글자 이상 입력해주세요.");
			return false;
		}

		// 비밀번호 확인 체크
		let confirmPassword = document.getElementById("confirmPassword").value;
		if (password !== confirmPassword) {
			alert("비밀번호와 비밀번호 확인이 일치하지 않습니다.");
			return false;
		}
		return true;
	}

</script>
</head>
<body>
<h1>[ 회원가입 ]</h1>
<div>
<form th:action="@{/member/join}" method="post">
	<p><label for="memberid">ID</label>
	 	<input type="text" id="memberid" name="memberid"placeholder="아이디 입력"><span id="msg"></span></p>
	<p><label for="name">PW</label>
		<input type="password" id="memberpw" name="memberpw" required="required" placeholder="비밀번호 입력"></p>
		<input type="password" id="confirmPassword" placeholder="비밀번호 다시 입력">
	<p><label for="name">이름</label>
		<input type="text" id="membername" name="membername" required="required" placeholder="이름 입력"></p>
	<p><label for="name">전화번호</label>
		<input type="text" id="phone" name="phone" required="required" placeholder="전화번호 입력"></p>
	<p><input type="submit" value="가입" id="submitButton" disabled="disabled">
</form>
</div>
</body>
</html>
