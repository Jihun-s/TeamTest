
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>[ Search ]</title>
        <script th:src="@{/js/jquery-3.6.0.js}"></script>
        <script>
            $(document).ready(function () {
                getList();

                // 카테고리 선택이 변경될 때마다 검색 수행
                document.getElementById('category').addEventListener('change', getList);

                // 검색어 입력이 변경될 때마다 검색 수행
                document.getElementById('title').addEventListener('input', getList);
            });

            function getList() {
                // 카테고리 선택에 따른 필터링
                const selectedCategory = document.getElementById('category').value;

                // 타이틀 검색에 따른 필터링
                const searchTitle = document.getElementById('title').value;

                $.ajax({
                    url: 'getList',
                    type: 'get',
                    dataType: 'json',
                    success: function (list) {
                        let filteredList = list;

                        // 카테고리 선택에 따른 필터링
                        if (selectedCategory !== 'all') {
                            filteredList = list.filter((item) => item.category === selectedCategory);
                        }

                        // 타이틀 검색에 따른 필터링
                        if (searchTitle) {
                            filteredList = filteredList.filter((item) => item.title.includes(searchTitle));
                        }

                        // 결과를 테이블에 표시
                        let htmlContent = '';
                        filteredList.forEach((item) => {
                            htmlContent += `
                                <tr>
                                    <td>${item.boardnum}</td>
                                    <td>${item.category}</td>
                                    <td><a href="read?boardnum=${item.boardnum}">${item.title}</a></td>
                                </tr>
                            `;
                        });
                        $('#searchList').html(htmlContent);
                    },
                    error: function (e) {
                        alert(JSON.stringify(e));
                    }
                });
            }
        </script>
    </head>
    <body>
        <h1>[ 판매 상품 검색 ]</h1>
        <select name="category" id="category">
            <option value="all">전체</option>
            <option value="computer">컴퓨터 및 주변기기</option>
            <option value="camera">카메라</option>
            <option value="car">자동차 용품</option>
        </select>
        <input type="text" id="title" />
        <table>
            <thead>
                <tr>
                    <th>번호</th>
                    <th>카테고리</th>
                    <th>제목</th>
                </tr>
            </thead>
            <tbody id="searchList"></tbody>
        </table>
    </body>
</html>
